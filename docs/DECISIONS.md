# Архитектурные решения проекта

## DEC-001: Raw-first ingestion
Все сообщения сохраняются в неизменённом виде.
Любая аналитика строится поверх raw-данных.

Причина:
- возможность переигрывать правила
- отсутствие потерь контекста
- защита от ошибочных интерпретаций

---

## DEC-002: Online классификация без ИИ (v1)
Классификация сообщений осуществляется:
- синхронно при ingestion
- на основе rule-based правил (regex / ключевые слова)

ИИ намеренно не используется на раннем этапе.

Причина:
- прозрачность
- объяснимость
- контроль качества
- минимизация ложных срабатываний

---

## DEC-003: UNCLASSIFIED — валидное состояние
Сообщение без классификации считается корректным результатом.

Причина:
- многие сообщения эмоциональны или недостаточно информативны
- отсутствие деталей делает инцидент непригодным для обработки
- система не должна «догадываться»

---

## DEC-004: Классификация ≠ инцидент
Классификация сообщения не означает, что:
- это инцидент
- его можно взять в работу
- он относится к конкретной КЕ

Определение конфигурационных единиц вынесено в следующий этап.

---

## DEC-005: Разделение этапов
Проект развивается по этапам:
1. Raw ingestion
2. Online классификация
3. Определение КЕ и связей
4. Анализ реакций и массовых инцидентов
5. Управляющие команды боту

Каждый этап завершается фиксацией.

---

## DEC-006: КЕ ≠ инцидент, но являются аналитической опорой

Конфигурационные единицы (АЗС, РМ, терминал) определяются независимо от:
- Service Desk
- статуса заявки
- жизненного цикла инцидента

Причина:
- аналитика повторяемости проблем строится по КЕ
- один инцидент может порождать несколько сообщений
- несколько инцидентов могут относиться к одной КЕ

---

## DEC-007: Enrichment через справочник, а не через сообщения

Идентификатор терминала (`tid`) и IP не извлекаются из текста сообщения,
а определяются **через справочник соответствий АЗС + РМ → терминал**.

Причина:
- клиенты не знают TID
- справочник является источником истины
- это позволяет связывать чат с CMDB/процессингом без прямой интеграции

---

## DEC-008: Reply — это слой видимости, а не управления

Reply бота:
- не зависит от ролей пользователя
- не является командой или действием
- не изменяет состояние системы

Reply возможен **только если найден полезный технический контекст**
(например, TID терминала).

Причина:
- минимизация шума
- защита от ложных срабатываний
- чёткое разделение наблюдаемости и управления
