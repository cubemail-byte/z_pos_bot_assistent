# tg-agent — КОНТЕКСТ ПРОЕКТА

## Что это за проект
Telegram-бот для работы в групповом чате с клиентом (POS / терминалы).
Задача бота — **тихо собирать все сообщения** в базу данных для последующего анализа
(типовые проблемы, эскалации, скорость реакции, SLA и т.д.).

Бот **не участвует в диалоге** и не мешает чату.

---

## Текущее состояние (актуально на YYYY-MM-DD)
- Бот запущен на VPS (Ubuntu 24.04) под systemd (`tg-agent.service`)
- Используется `aiogram`
- Деплой через `git pull + restart` (`tg-agent-deploy`)
- Конфигурация:
  - `.env` — только на VPS (секреты)
  - `config.yaml` — в репозитории (параметры работы)
- Хранилище:
  - SQLite
  - Файл БД: `/opt/tg-agent/data/agent.db`
  - Таблица `messages` — сырые сообщения без обработки

---

## Что бот делает сейчас
- Подключается к Telegram
- Получает **все текстовые сообщения**
- Сохраняет их в БД (raw ingestion)
- Команды (`/ping`, `/start`) — только для технической проверки

---

## Что бот НЕ делает (принципиально)
- Не парсит сообщения
- Не классифицирует проблемы
- Не отвечает в группах
- Не использует LLM / ИИ
- Не анализирует SLA

---

## Структура репозитория
- `app/bot.py` — точка входа, обработка сообщений
- `app/storage.py` — работа с SQLite
- `config.yaml` — параметры работы бота (без секретов)
- `.env` — секреты (на VPS, в git не хранится)
- `requirements.txt`
- `docs/` — документация и контекст проекта

---

## Ближайшие шаги (план)
1. Зафиксировать режим «тихого» бота в группах
2. Добавить базовые админ-команды (статистика, проверка)
3. Ввести слой парсинга сообщений
4. Разделить raw-сообщения и результаты анализа
5. Анализ эскалаций и реакции

---

## Ключевой принцип
**Сначала собираем данные, потом думаем, как их анализировать.**
Raw-данные — источник истины.
