version: 1
extractor: regex:v1

# Справочник типов сущностей (для самодокументации и будущей валидации)
entity_types:
  # из текста (regex)
  - azs
  - workplace
  - sd_ticket
  - terminal
  - sd_dt

  # из справочника terminal_directory (enrichment)
  - tid              # terminal_id банка (строго 8 цифр)
  - ip               # ip рабочего места (IPv4 строкой)
  - serial_number    # серийный номер терминала (пока не заполняем)

patterns:
  sd_ticket:
    - name: "sd_ticket_7digits"
      regex: "(?i)\\b(?:sd|service\\s*desk|servicedesk|заявка|тикет)\\s*[:#№]?\\s*(\\d{7})\\b"
      confidence: 0.95

  azs:
    - name: "azs_2to4_digits"
      regex: "(?i)\\b(?:азс|aзс)\\s*[:#№]?\\s*(\\d{2,4})\\b"
      confidence: 0.85

  workplace:
    - name: "workplace_1to2_digits"
      regex: "(?i)\\b(?:рм|раб\\.?\\s*место|workplace)\\s*[:#№]?\\s*(\\d{1,2})\\b"
      confidence: 0.8

    # Новые форматы: "касса 3", "на кассе №3", "касса#3"
    - name: "cashdesk_1to2_digits"
      regex: "(?i)\\bкасс[аеи]\\s*[:#№]?\\s*(\\d{1,2})\\b"
      confidence: 0.75

    # "К-3", "К3", "К №3" (осторожно: коротко, но полезно в полях)
    - name: "kassa_short_k_1to2_digits"
      regex: "(?i)\\bк\\s*[-#№]?\\s*(\\d{1,2})\\b"
      confidence: 0.6

    # "пост 2", "пост№2"
    - name: "post_1to2_digits"
      regex: "(?i)\\bпост\\s*[:#№]?\\s*(\\d{1,2})\\b"
      confidence: 0.65

    # "место 1", "рабочее место 1" (кроме уже имеющегося "раб. место")
    - name: "place_1to2_digits"
      regex: "(?i)\\bместо\\s*[:#№]?\\s*(\\d{1,2})\\b"
      confidence: 0.6

    - name: "workplaces_list"
      regex: "(?i)\\bрабоч(?:ем|их)\\s+мест(?:е|ах)\\b[^\\d#№]*(?:[#№]\\s*)?(\\d{1,2}(?:\\s*[,;/]\\s*\\d{1,2})+)"
      confidence: 0.8

  terminal:
    - name: "terminal"
      regex: "(?i)\\b(?:терминал|pos)\\s*[:#№]?\\s*([A-Z0-9\\-]{3,20})\\b"
      confidence: 0.7

  sd_dt:
    - name: "sd_dt_ru"
      regex: "\\b(\\d{1,2}[\\./]\\d{1,2}[\\./]\\d{2,4})\\s*(\\d{1,2}:\\d{2}(?::\\d{2})?)\\b"
      confidence: 0.5
